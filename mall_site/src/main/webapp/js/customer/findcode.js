$(function(){$("#checkCodeA").click(function(){$("#checkCodeImg").click()});$("#code").blur(function(){$(this).parent().find(".patchca_tips").hide().html("验证码错误").css("color","#dd6330")});$("#username").focus(function(){$(this).parent().find(".ne_tips").show().html("请输入手机号").css("color","#dd6330")});$("#username").blur(function(){$(this).parent().find(".ne_tips").hide().html("验证中,请稍后...").css("color","#dd6330")})});function checkNewPwd(){var x=$("#npwd").val();if(x.length<6||x.length>20){$(".npwd_tip").show().html("密码格式不正确,请输入6-20位长度的密码!");return false}$(".npwd_tip").hide().html("请输入登录密码").css("color","gray");return true}function checkRePwd(){var x=$("#npwd").val();var y=$("#repwd").val();if($("#npwd").val().trim().length==0&&$("#repwd").val().trim().length==0){$(".repwd_tip").show().html("请输入登录密码!");return false}if(x!=y){$(".repwd_tip").show().html("您两次输入的密码不相同!");return false}$(".repwd_tip").hide().html("请输入登录密码").css("color","gray");return true}function gofindcode(){if($("#username").val().trim().length==0){$("#username").parent().find(".uesrname_tips").show().html("请输入手机号").css("color","#dd6330");return}var enterValue=$("#code").val();$.ajax({url:"checkpatchca.htm?enterValue="+enterValue,context:document.body,success:function(data){if(enterValue!=""){if(data==0){$(".patchca_tips").show().css("color","#dd6330");$(".patchca_tips").html("验证码错误");$("#checkCodeImg").click();return false}else{var datas="&username="+$("#username").val();jQuery.ajax({type:"get",url:"checkusernameflag.htm",data:datas,timeout:10000,success:function(html){if(html==1){$(".uesrname_tips").hide();location.href="validuser.html"}else{$(".uesrname_tips").show().html("手机号不存在!");$("#checkCodeImg").click()}},error:function(){}})}}else{$(".patchca_tips").show().css("color","#dd6330");$(".patchca_tips").html("请输入验证码")}}})}function sendEmail(){var enterValue=$("#code").val();$.ajax({url:"checkpatchca.htm?enterValue="+enterValue,context:document.body,success:function(data){if(data==0){$(".patchca_tips").show().css("color","#dd6330");$(".patchca_tips").html("验证码错误");$("#checkCodeImg").click();return false}else{$.ajax({type:"post",url:"newsendeamil.htm",async:true,success:function(obj){if(obj==1){location.href="sendsuccess.html"}else{$(".info1").text("提示");$(".info2").text("验证邮箱失败，请稍后再试！");dia(2)}},error:function(){$(".info1").text("提示");$(".info2").text("验证邮箱失败，请稍后再试！");dia(2)}})}}})}function updatePwd(){var flag=true;if(!checkNewPwd()){flag=false}if(!checkRePwd()){flag=false}if(!flag){return}var datas="1=1";datas+="&customerPassword="+$("#npwd").val();jQuery.ajax({type:"post",url:"setpwd.htm",data:datas,timeout:10000,success:function(html){if(html==1){location.href="updatesucess.html"}else{dia(2)}},error:function(){dia(2)}})}function sdia(dname){$(".bh-mask").fadeIn();$("#"+dname).fadeIn()}function scls(t){$(".bh-mask").fadeOut();$(t).parents(".bh-dialog").fadeOut()}function addToFavorite(siteName){try{window.external.AddFavorite($("#basePath").val(),siteName)}catch(e){try{window.sidebar.addPanel($("#basePath").val(),siteName,"")}catch(e){$(".collect_tip_cancel").click(function(){cls()});sdia("ctDia")}}}$(function(){$(".cartit").on("mouseover",minicartonload);$("#delect_minicart").on("click",function(){var emp1=$(this).next().val();var emp2=$(this).next().next().val();$.ajax({url:"../delshoppingcartbyid.htm?shoppingCartId="+emp1+"&goodsInfoId="+emp2,async:false,success:function(dats){if(dats==1){minicartonload()}}})});minicartonload()});function minicartonload(){$.ajaxSetup({cache:false});$.ajax({url:"../minisscart.htm",type:"post",async:false,success:function(datee){var cartgoods=datee.shopcart.miniGoodsList;var cust=datee.cust;if(cust!=null){$(".cart_empty").html("<p style='height:35px;'>您的购物车是空的<br /></p>")}var empvalue=0;if(cartgoods!=null){$(".sc_num em").html(cartgoods.length)}else{$(".sc_num em").html("0")}var countgoods=0;if(cartgoods!=null&&cartgoods.length>0){$(".cart_empty").addClass("none");$(".cart_cont").removeClass("none");$(".mcBoxList").html("");for(var i=0;i<cartgoods.length;i++){countgoods+=cartgoods[i].buNum;var cartgood=' <div class="mcOrder clearfix">'+' <div class="mcItem">'+'<a  href="item/'+cartgoods[i].goodsInfoId+'" class="img">'+'<div class="table-cell">'+'   <i></i><img src="'+cartgoods[i].productPic+'" alt="">'+"  </div>"+" </a>"+"</div>"+'<div class="mcSqe">'+'<p><a  href="item/'+cartgoods[i].goodsInfoId+'">'+cartgoods[i].productName+"</a></p>"+"</div>"+' <div class="mcAmount" style="position:relative;left:30px;">'+'<span class="amount">'+cartgoods[i].buNum+"</span>"+"</div>"+'<div class="mcCost">'+'<a href="" class="del"  id = "delect_minicart">删除</a>'+"<input type= 'hidden' class= 'goodsid' value = '"+cartgoods[i].shoppingCartId+"'>"+"<input type= 'hidden' class= 'goodsinfo' value = '"+cartgoods[i].goodsInfoId+"'>"+'<span class="mcPrice">&yen;'+cartgoods[i].productPrice+'<em style="color:#666">×'+cartgoods[i].buNum+"</em></span>"+" </div>"+"</div>";$(".mcBoxList").append(cartgood);$(".mcOrder").each(function(){var $this=$(this);
    $this.mouseover(function(){$this.find(".minus, .plus").css("visibility","visible");$this.find(".del").show()}).mouseout(function(){$this.find(".minus, .plus").css("visibility","hidden");$this.find(".del").hide()})});empvalue=accAdd(empvalue,accMul(cartgoods[i].productPrice,cartgoods[i].buNum))}$(".mcNumTotal").text(countgoods);$(".mcNumChecked").text(countgoods);$(".cartNum").text(countgoods);$(".mcTotalFee").text(empvalue);$(".emCartBox").hide()}else{$(".emCartBox").show()}}})}function getCode(){$("#sendCode").attr("disabled","disabled");$.ajax({type:"get",url:"sendcodefindpwd.htm",async:true,success:function(data){if(data==1){$(".ju_s").text(59);$("#code_tip").show();setTimeout(countDown,1000);$("#mcode").removeAttr("disabled");$(".sub_btn").removeAttr("disabled");$("#mobile").attr("disabled","disabled");$("#sendCode").attr("disabled","disabled")}else{if(data==0){dia(2);$("#sendMobileCode").removeAttr("disabled")}else{if(data==-1){$("#code_tip").show();$(".ju_s").text(59);if($(".ju_s").text()==59){$(".resend").text("");$("#code_tip").find(".resend").remove();$("#code_tip").find("br").remove();$("#code_tip").html("<span class='resend'>60秒内只能获取一次验证码,请稍后重试</span>")}else{$(".resend").text("");$("#code_tip").find(".resend").remove();$("#code_tip").find("br").remove();$("#code_tip").append("<br/><span class='resend'>60秒内只能获取一次验证码,请稍后重试</span>")}$("#mcode").removeAttr("disabled")}}}},error:function(){$("#submitCode").removeAttr("disabled");dia(2)}});function countDown(){var time=$(".ju_s").text();$(".ju_s").text(time-1);if(time==1){$("#code_tip").hide();$("#sendCode").removeAttr("disabled");$("#mobile").removeAttr("disabled")}else{setTimeout(countDown,1000)}}}function tofindpwd(type){if(!checkMCode()){return}var res=0;var checkCode=$("#mcode").val();$.ajax({url:"validate/getMCode.htm?code="+checkCode,context:document.body,async:false,success:function(data){res=data}});if(res==1){$(".mcode_tip").hide();$(".mcode_tip").html("请输入手机验证码")}else{if(res==-1){$(".mcode_tip").show();$(".mcode_tip").html("手机验证码已经失效");return}else{$(".mcode_tip").show();$(".mcode_tip").html("手机验证码错误");return}}location.href="resetpwd.html"}function checkMCode(){var checkCode=$("#mcode").val();if(checkCode!=""){$(".mcode_tip").hide().css("color","#dd6330");$(".mcode_tip").html("请输入手机验证码");return true}else{$(".mcode_tip").show().css("color","#dd6330");$(".mcode_tip").html("手机验证码错误");return false}};